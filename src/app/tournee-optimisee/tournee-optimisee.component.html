<app-sidebar></app-sidebar>

<div class="pl-72 pr-6 py-6 bg-gradient-to-br from-gray-50 via-white to-gray-100 min-h-screen">
    <!-- üó∫Ô∏è Titre principal -->
    <h2 class="text-3xl font-extrabold text-gray-800 mb-8 flex items-center gap-3 animate-fade-in">
        <i class="lucide lucide-map-pin w-8 h-8 text-green-600"></i> Tourn√©e Optimis√©e
    </h2>

    <!-- üîπ Contenu principal -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 animate-fade-in-up">
        <!-- üìÖ Calendrier interactif -->
        <div class="glass-card rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300">
            <h3 class="text-xl font-semibold text-gray-700 mb-6 flex items-center gap-3">
                <i class="lucide lucide-calendar-days w-6 h-6 text-blue-500"></i> Calendrier des Rendez-vous
            </h3>
            <div class="calendar-wrapper rounded-xl overflow-hidden border border-gray-200 shadow-inner">
                <full-calendar [options]="calendarOptions"></full-calendar>
            </div>
        </div>

        <!-- üó∫Ô∏è Carte Mapbox -->
        <div class="glass-card rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300">
            <h3 class="text-xl font-semibold text-gray-700 mb-6 flex items-center gap-3">
                <i class="lucide lucide-map w-6 h-6 text-green-500"></i> Carte de Tourn√©e
            </h3>
            <div #mapContainer class="map-container rounded-xl overflow-hidden border-2 border-gray-200 shadow-inner" style="height: 500px;"></div>
        </div>
    </div>

    <!-- üß≠ R√©sum√© de l‚Äôitin√©raire -->
    <div class="mt-12 animate-fade-in-up">
        <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-3">
            <i class="lucide lucide-route w-6 h-6 text-purple-500"></i> Itin√©raire Optimis√©
        </h3>

        <div class="glass-card rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 text-gray-700 space-y-3">
            <ng-container *ngIf="optimizedRoute; else noRoute">
                <p class="text-lg"><strong>üìè Distance totale :</strong> {{ optimizedRoute.distance | number:'1.1-2' }} km</p>
                <p class="text-lg"><strong>‚è±Ô∏è Dur√©e estim√©e :</strong> {{ optimizedRoute.duration | number:'1.0-0' }} minutes</p>
            </ng-container>
            <ng-template #noRoute>
                <p class="text-sm text-gray-500 italic">Aucune tourn√©e optimis√©e disponible.</p>
            </ng-template>
        </div>
    </div>

    <!-- üöÄ Bouton vers Dossier M√©dical -->
    <div class="mt-10 flex justify-center">
        <button routerLink="/medical-dossier" class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold rounded-xl shadow-lg hover:from-green-600 hover:to-green-700 transition-all duration-300 flex items-center gap-2">
            <i class="lucide lucide-folder-medical w-5 h-5"></i> Cr√©er Dossier M√©dical
        </button>
    </div>

</div>
<!-- üåü Modal g√©n√©rique -->
<div *ngIf="showModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
    <div class="bg-white rounded-2xl shadow-2xl w-96 p-6 animate-fade-in-up">
        <h2 class="text-xl font-bold text-gray-800 mb-4">{{ modalTitle }}</h2>
        <p class="text-gray-600 mb-6 whitespace-pre-line">{{ modalMessage }}</p>
        <div class="flex justify-end gap-3">
            <button (click)="closeModal(false)" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">Annuler</button>
            <button *ngIf="modalConfirmCallback" (click)="closeModal(true)" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Confirmer</button>
        </div>
    </div>
</div>

<!-- ü©∫ Modal sp√©cifique dossier m√©dical -->
<div *ngIf="showMedicalModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-gradient-to-br from-blue-50 to-green-50 rounded-2xl shadow-2xl w-[420px] p-6 border border-blue-200 animate-fade-in-up">
        <div class="flex items-center gap-3 mb-4">
            <span class="text-3xl">ü©∫</span>
            <h2 class="text-xl font-bold text-blue-800">Cr√©er un dossier m√©dical</h2>
        </div>
        <p class="text-gray-700 mb-6">
            Voulez-vous cr√©er un <strong>dossier m√©dical</strong> pour
            <span class="text-blue-600 font-semibold">{{ medicalPatientName }}</span> (RDV le {{ medicalDate }}) ?
        </p>
        <div class="flex justify-end gap-3">
            <button (click)="closeMedicalModal(false)" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">Annuler</button>
            <button (click)="closeMedicalModal(true)" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Cr√©er</button>
        </div>
    </div>
</div>